<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Do Memory Inforamation Management Web Application</title>
    <script src="scripts/jquery-1.9.1.min.js"></script>
    <script src="scripts/jsrender.js"></script>
    <link href="scripts/lib/bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" />
    <link href="scripts/lib/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>

    <h2>Do Memory</h2
    <table>
    <thead>
            <tr>
                <th>Name</th>
                <th>Description</th>
                <th>Status</th>
            </tr>
        </thead>
       <tbody id="tasklist"></tbody>
   </table>
 

    <table id="tasklist"></table>

   <h2> Add Info</h2>
    <input id="inpName" class="input-medium" type="text" placeholder="Name">
    <input id="inpDescription" class="input-xxlarge" type="text" placeholder="Description">
    <input id="inpStatus" class="input-xlarge" type="text" placeholder="Status">
    <button id="createtask" type="submit" class="btn btn-primary">Save changes</button>
    <button id="deletetask" type="submit" class="btn btn-primary">Delete Task</button>

 

    <script>
        /* Compile markup as named templates */
        $.templates({
            titleTemplate: "<tr><td colspan=3>{{>name}}</td></tr>",
            detailTemplate: "<tr><td>{{>name}}</td><td>Released: {{>releaseYear}}</td><td>director: {{>director}}</td></tr>",
            taskTemplate: "<tr><td>{{>id}}</td><td>{{>Name}}</td><td>{{>Description}}</td><td>{{>Status}}</td></tr>"
        });


        // get tasks
        $.when($.ajax({ url: "/task", data: {}, type: "GET", contentType: "application/json;charset=utf-8" }))
         .then(function (response, textstatus, xhr)
            {
                // console.log(response);
             $('#tasklist').html($.render.taskTemplate(response));
         });

      
        // create a new task
        $('#createtask').click(function (e)
        {
            e.preventDefault();
            var task = { id: 4, "Name": $('#inpName').val(), "Description": $('#Description').val(), "Status" : $('#Status').val() };

           

            $.when($.ajax({ url: "api/info", data: task, type: "POST", dataType: "json"}))
             .then(function (response, textstatus, xhr)
             {
                 // add task to the list
                 $('#tasklist').append($.render.taskTemplate(task));
             });

        });


        // delete task
        $('#deletetask').click(function (e)
        {
            e.preventDefault();
            var task = { id: 4 }; 

            $.when($.ajax({ url: "api/task/4", data: task, type: "DELETE", dataType: "json" }))
             .then(function (response, textstatus, xhr)
             {
                 // add task to the list
                 // $('#tasklist').append($.render.taskTemplate(task));
             });

        });
       
     
    </script>
</body>
</html>
